color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(( A %*% ~ .), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pve.eigen$pve %*% t(A)
t(pve.eigen$pve %*% t(A))
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis((~ . t(A)), name = "Eigenvalues")
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis((~ . t(A)), name = "Eigenvalues")
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . t(A), name = "Eigenvalues")
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . t(A), name = "Eigenvalues")
t(A)
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
cpve.eigen.plot
2 %*% t(A)
A
diag(5)
lower.tri(5)
(m2 <- matrix(1:20, 4, 5))
lower.tri(m2)
m2[lower.tri(m2)] <- NA
m2
k = 5
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A
k = 5
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
A
for(k in 1:500){
print(k)
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
}
fo(k in 1:500){
for(k in 1:500){
print(k)
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
}
k = 1
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
k = 2
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
k = 1
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
A
(k in 2:500){
for(k in 2:500){
print(k)
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
}
k = 2
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
print(ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")))
for(k in 2:500){
print(k)
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
print(ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")))
}
for(k in 3:500){
print(k)
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
}
k = 10
A <- matrix(rep(1,k), nrow = k, ncol  = k)
A[upper.tri(A)] <- 0
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_discrete(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . %*% t(A), name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . /100, name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pve.eigen$diff2
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(~ . /25, name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = pve.eigen$eig.val
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained",
sec.axis = sec_axis(pve.eigen$eig.val)
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained"
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained"
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1)
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
) + geom_point() +
scale_y_continuous(
"Cumulative proportion of variance explained"
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1)
pve.eigen.plot <- ggplot(pve.eigen, aes(pc, pve)) +
geom_col(aes(x = pc , y = pve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = pve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point()+   ylim(0, 100) +
scale_y_continuous(
"Proportion of variance explained",
sec.axis = sec_axis(~ . /25, name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
) + geom_point() +   ylim(0, 100) +
scale_y_continuous(
"Cumulative proportion of variance explained"
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1)
pve.eigen.plot <- ggplot(pve.eigen, aes(pc, pve)) +
geom_col(aes(x = pc , y = pve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = pve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point()+
scale_y_continuous(breaks=seq(0,100,by=1),
"Proportion of variance explained",
sec.axis = sec_axis(~ . /25, name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pve.eigen.plot
pve.eigen.plot <- ggplot(pve.eigen, aes(pc, pve)) +
geom_col(aes(x = pc , y = pve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = pve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point()+
scale_y_continuous(breaks=seq(0,100,by=10),
"Proportion of variance explained",
sec.axis = sec_axis(~ . /25, name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pve.eigen.plot
pve.eigen.plot <- ggplot(pve.eigen, aes(pc, pve)) +
geom_col(aes(x = pc , y = pve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = pve),
color = "black"
)+geom_hline(yintercept = 25, col = "black",
linetype = "dashed") + geom_point()+
scale_y_continuous(limits =c(0,100),
"Proportion of variance explained",
sec.axis = sec_axis(~ . /25, name = "Eigenvalues")
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pve.eigen.plot
cpve.eigen.plot <- ggplot(pve.eigen, aes(pc, cpve)) +
geom_col(aes(x = pc , y = cpve),
color = "gray70",
fill = "gray70", width = 0.5) +
geom_line(aes(x = pc,
y = cpve),
color = "black"
) + geom_point() +  scale_y_continuous(limits =c(0,100),
"Cumulative proportion of variance explained"
) + labs(x = "Principal Component") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1)
ggsave(ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1),
filename = "Output/PVE_PCA.png",
height = 1070, width = 492)
ggsave(ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1),
filename = "Output/PVE_PCA.png",
height = 1070/10, width = 492/10)
1070/10
1070/20
ggsave(ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1),
filename = "Output/PVE_PCA.png",
height = 1070/22, width = 492/22)
ggsave(ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1),
filename = "Output/PVE_PCA.png",
width= 1070/22, height  = 492/22)
ggsave(ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1),
filename = "Output/PVE_PCA.png",
width= 1070/52, height  = 492/52)
ggsave(ggarrange(pve.eigen.plot, cpve.eigen.plot, ncol = 2, nrow = 1),
filename = "Output/PVE_PCA.png",
width= 1070/100, height  = 492/100)
